name: Auto Comment on PR and Issue

on:
  pull_request_target:
    types: [opened]
  issues:
    types: [opened]
  pull_request:
    types: [closed]

permissions:
  issues: write
  pull-requests: write

jobs:
  comment-pr:
    runs-on: ubuntu-latest
    if: github.event_name == 'pull_request_target'

    steps:
    - name: Add Comment to Pull Request
      run: |
        COMMENT=$(cat <<EOF
        {
          "body": "Thank you for submitting your pull request! 🙌 We'll review it as soon as possible. In the meantime, please ensure that your changes align with our [CONTRIBUTING.md](https://github.com/your-repo/your-project/blob/main/CONTRIBUTING.md). If there are any specific instructions or feedback regarding your PR, we'll provide them here. Thanks again for your contribution! 😊"
        }
        EOF
        )
        RESPONSE=$(curl -s -o response.json -w "%{http_code}" \
          -X POST \
          -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
          -H "Accept: application/vnd.github.v3+json" \
          https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.pull_request.number }}/comments \
          -d "$COMMENT")
        cat response.json
        if [ "$RESPONSE" -ne 201 ]; then
          echo "Failed to add comment"
          exit 1
        fi
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  comment-issue:
    runs-on: ubuntu-latest
    if: github.event_name == 'issues'

    steps:
    - name: Add Comment to Issue
      run: |
        COMMENT=$(cat <<EOF
        {
          "body": "Thank you for opening this issue! 😊 We'll review it as soon as possible. Please make sure you've provided all necessary details and context to help us address it effectively. If you have any additional information or updates, feel free to add them here. Thanks for contributing! 🙏"
        }
        EOF
        )
        RESPONSE=$(curl -s -o response.json -w "%{http_code}" \
          -X POST \
          -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
          -H "Accept: application/vnd.github.v3+json" \
          https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.issue.number }}/comments \
          -d "$COMMENT")
        cat response.json
        if [ "$RESPONSE" -ne 201 ]; then
          echo "Failed to add comment"
          exit 1
        fi
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  comment-pr-merged:
    runs-on: ubuntu-latest
    if: github.event.pull_request.merged == true

    steps:
    - name: Add Comment to Merged Pull Request
      run: |
        COMMENT=$(cat <<EOF
        {
          "body": "Congratulations! Your pull request has been merged. 🎉 Thank you for your contribution! 🙏 If you have any further improvements or ideas, feel free to open another pull request. We appreciate your efforts and look forward to more contributions from you!"
        }
        EOF
        )
        RESPONSE=$(curl -s -o response.json -w "%{http_code}" \
          -X POST \
          -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
          -H "Accept: application/vnd.github.v3+json" \
          https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.pull_request.number }}/comments \
          -d "$COMMENT")
        cat response.json
        if [ "$RESPONSE" -ne 201 ]; then
          echo "Failed to add comment"
          exit 1
        fi
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
